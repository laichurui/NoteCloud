# 简介

PEG，即解析表达式语法（Parsing Expression Grammar）。可以方便地、无歧义地表达一个语法。

[解析表达文法](../static/解析表达文法-中文维基百科.pdf)

[peg论文](../static/PEG.pdf)

[peg维基百科](https://m.tw.lvfukeji.com/baike-%E8%A7%A3%E6%9E%90%E8%A1%A8%E8%BE%BE%E6%96%87%E6%B3%95)

## 语法

解析规则以 **A <- e** 的形式出现，这里 A 是一个非终结符，e(expression) 是一个解析表达式。

## 序列: e1 e2

首先调用 e1， 如果 e1成功， 接着对 e1 消耗剩下的输入字符串调用 e2， 最后返回结果。如果 e1 或者 e2 失败，那么序列表达式 e1e2 失败。

## 有序选择: e1 / e2

首先调用 e1， 如果 e1成功， 立刻返回结果。否则如果 e1 失败，选择操作符回溯到输入字符串匹配 e1 的原始位置，调用 e2， 最后返回 e2 结果。

## 模糊匹配

几种格式：

* 零个或更多: e*
* 一个或更多: e+
* 可选: e?

在PEG里这些操作符总是执行**贪婪匹配**，那就是消耗尽可能多的输入，而且绝对不回溯。例如，解析表达式 a\* 总是尽可能多的消耗输入字符串中连续出现的a，解析表达式(a* a)则必然会失败因为前半部分a*绝对不会留下一丁点a给后半部分去匹配。

## 断言

句法断言包括肯定断言和否定断言：

* 肯定断言: &e
* 否定断言: !e

&e 表达式调用子表达式 e，如果 e 成功，则返回成功；否则返回失败。**无论结果如何都不消耗任何字符**。